# ================================================================
# RAILWAY ENVIRONMENT VARIABLES TEMPLATE
# ================================================================
# Copy this file to .env.railway and fill in your values
# These variables should be configured in Railway Dashboard

# ================================================================
# CORE DJANGO SETTINGS
# ================================================================

# CRITICAL: Generate a new secret key for production!
# python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
DJANGO_SECRET_KEY=your-production-secret-key-here-minimum-50-characters

# Environment: production, staging, development
DJANGO_ENV=production

# Django settings module
DJANGO_SETTINGS_MODULE=core.settings.production

# Debug mode - ALWAYS False in production
DEBUG=False

# Allowed hosts - Railway will auto-set RAILWAY_PUBLIC_DOMAIN
# Format: domain1.com,domain2.com,*.railway.app
ALLOWED_HOSTS=${{RAILWAY_PUBLIC_DOMAIN}},*.railway.app

# ================================================================
# DATABASE (PROVIDED BY RAILWAY)
# ================================================================

# Railway provides this automatically when you add Postgres
DATABASE_URL=${{DATABASE_URL}}

# Optional: Connection pool settings
DB_CONN_MAX_AGE=600
DB_POOL_SIZE=20

# ================================================================
# REDIS (PROVIDED BY RAILWAY)
# ================================================================

# Railway provides this automatically when you add Redis
REDIS_URL=${{REDIS_URL}}

# Celery configuration
CELERY_BROKER_URL=${{REDIS_URL}}
CELERY_RESULT_BACKEND=${{REDIS_URL}}
CELERY_WORKER_CONCURRENCY=4
CELERY_WORKER_PREFETCH=1

# ================================================================
# URLS AND DOMAINS
# ================================================================

# Backend URL (your Railway backend service URL)
BACKEND_URL=https://${{RAILWAY_PUBLIC_DOMAIN}}

# Frontend URL (your Railway frontend service URL)
FRONTEND_URL=https://your-frontend.railway.app

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=https://your-frontend.railway.app,https://your-domain.com

# ================================================================
# EMAIL CONFIGURATION
# ================================================================

# Email backend
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend

# SMTP settings (example for SendGrid)
EMAIL_HOST=smtp.sendgrid.net
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=apikey
EMAIL_HOST_PASSWORD=your-sendgrid-api-key

# Or use Resend (recommended)
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxx

# Email addresses
DEFAULT_FROM_EMAIL=noreply@yourdomain.com
SUPPORT_EMAIL=support@yourdomain.com
ADMIN_EMAIL=admin@yourdomain.com

# ================================================================
# OPENAI CONFIGURATION
# ================================================================

# OpenAI API key for AI features
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxx

# Optional: OpenAI settings
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_MAX_TOKENS=2000
OPENAI_TEMPERATURE=0.7

# ================================================================
# PAYMENT GATEWAYS
# ================================================================

# Stripe (Production keys)
STRIPE_PUBLIC_KEY=pk_live_xxxxxxxxxxxxxxxxxxxxx
STRIPE_SECRET_KEY=sk_live_xxxxxxxxxxxxxxxxxxxxx
STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxxxxxxxxxx

# MercadoPago (Production credentials)
MERCADOPAGO_PUBLIC_KEY=APP_USR-xxxxxxxxxxxxxxxxxxxxx
MERCADOPAGO_ACCESS_TOKEN=APP_USR-xxxxxxxxxxxxxxxxxxxxx
MERCADOPAGO_WEBHOOK_SECRET=your-webhook-secret

# Default payment gateway
DEFAULT_PAYMENT_GATEWAY=stripe

# ================================================================
# OPEN BANKING (PLUGGY)
# ================================================================

# Pluggy API credentials
PLUGGY_CLIENT_ID=xxxxxxxxxxxxxxxxxxxxx
PLUGGY_CLIENT_SECRET=xxxxxxxxxxxxxxxxxxxxx
PLUGGY_BASE_URL=https://api.pluggy.ai
PLUGGY_CONNECT_URL=https://connect.pluggy.ai
PLUGGY_USE_SANDBOX=False

# Webhook URL for Pluggy (auto-generated)
PLUGGY_WEBHOOK_URL=https://${{RAILWAY_PUBLIC_DOMAIN}}/api/banking/webhooks/pluggy/

# ================================================================
# STORAGE (OPTIONAL)
# ================================================================

# AWS S3 for media files (optional but recommended for production)
USE_S3=True
AWS_ACCESS_KEY_ID=xxxxxxxxxxxxxxxxxxxxx
AWS_SECRET_ACCESS_KEY=xxxxxxxxxxxxxxxxxxxxx
AWS_STORAGE_BUCKET_NAME=your-bucket-name
AWS_S3_REGION_NAME=us-east-1
AWS_S3_CUSTOM_DOMAIN=your-bucket.s3.amazonaws.com
AWS_S3_FILE_OVERWRITE=False
AWS_DEFAULT_ACL=private

# ================================================================
# MONITORING AND LOGGING
# ================================================================

# Sentry for error tracking (highly recommended)
SENTRY_DSN=https://xxxxxxxxxxxxxxxxxxxxx@sentry.io/xxxxx
SENTRY_ENVIRONMENT=${{RAILWAY_ENVIRONMENT}}
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# LogDNA / DataDog / New Relic (optional)
LOGDNA_KEY=xxxxxxxxxxxxxxxxxxxxx
DATADOG_API_KEY=xxxxxxxxxxxxxxxxxxxxx
NEWRELIC_LICENSE_KEY=xxxxxxxxxxxxxxxxxxxxx

# ================================================================
# SECURITY SETTINGS
# ================================================================

# Security headers and SSL
SECURE_SSL_REDIRECT=True
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True
SECURE_CONTENT_TYPE_NOSNIFF=True
SECURE_BROWSER_XSS_FILTER=True
X_FRAME_OPTIONS=DENY

# Session settings
SESSION_ENGINE=django.contrib.sessions.backends.cache
SESSION_CACHE_ALIAS=default
SESSION_COOKIE_AGE=86400  # 24 hours
SESSION_EXPIRE_AT_BROWSER_CLOSE=False

# CSRF settings
CSRF_COOKIE_HTTPONLY=True
CSRF_COOKIE_AGE=31536000  # 1 year
CSRF_USE_SESSIONS=False

# ================================================================
# FEATURE FLAGS
# ================================================================

# Feature toggles
ENABLE_AI_INSIGHTS=true
ENABLE_OPEN_BANKING=true
ENABLE_MULTI_CURRENCY=false
ENABLE_WEBHOOKS=true
ENABLE_API_RATE_LIMITING=true

# ================================================================
# SUBSCRIPTION AND BILLING
# ================================================================

# Trial configuration
TRIAL_PERIOD_DAYS=14
ENABLE_AUTO_RENEWAL=true

# Payment retry settings
PAYMENT_RETRY_ATTEMPTS=3
PAYMENT_RETRY_INTERVAL_HOURS=24

# Notification settings
SEND_PAYMENT_RECEIPTS=true
SEND_TRIAL_EXPIRATION_WARNINGS=true
TRIAL_WARNING_DAYS=3,7

# Currency and tax
DEFAULT_CURRENCY=USD
APPLY_TAX=false
TAX_RATE=0.0

# ================================================================
# API RATE LIMITING
# ================================================================

# Rate limiting (requests per period)
RATELIMIT_ENABLE=true
RATELIMIT_USE_CACHE=default
RATELIMIT_DEFAULT=1000/hour
RATELIMIT_LOGIN=10/hour
RATELIMIT_API=5000/day

# ================================================================
# DEPLOYMENT CONFIGURATION
# ================================================================

# Gunicorn settings
WEB_CONCURRENCY=4
GUNICORN_TIMEOUT=120
GUNICORN_GRACEFUL_TIMEOUT=30
GUNICORN_MAX_REQUESTS=1000
GUNICORN_MAX_REQUESTS_JITTER=100

# Health check settings
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/api/health/

# Deployment notifications
DEPLOYMENT_WEBHOOK_URL=https://hooks.slack.com/services/xxxxx
DEPLOYMENT_NOTIFICATION_EMAIL=devops@yourdomain.com

# ================================================================
# SUPERUSER (OPTIONAL - FIRST DEPLOYMENT ONLY)
# ================================================================

# Create initial superuser on first deployment
# Remove these after first deployment for security
CREATE_SUPERUSER=false
DJANGO_SUPERUSER_EMAIL=admin@yourdomain.com
DJANGO_SUPERUSER_PASSWORD=change-this-immediately

# ================================================================
# RAILWAY-SPECIFIC VARIABLES (AUTO-PROVIDED)
# ================================================================

# These are automatically provided by Railway
# PORT=${{PORT}}
# RAILWAY_ENVIRONMENT=${{RAILWAY_ENVIRONMENT}}
# RAILWAY_PUBLIC_DOMAIN=${{RAILWAY_PUBLIC_DOMAIN}}
# RAILWAY_DEPLOYMENT_ID=${{RAILWAY_DEPLOYMENT_ID}}
# RAILWAY_PROJECT_ID=${{RAILWAY_PROJECT_ID}}
# RAILWAY_SERVICE_ID=${{RAILWAY_SERVICE_ID}}

# ================================================================
# FRONTEND ENVIRONMENT VARIABLES
# ================================================================
# These should be set in the frontend service

NEXT_PUBLIC_APP_NAME=Finance Hub
NEXT_PUBLIC_APP_URL=https://your-frontend.railway.app
NEXT_PUBLIC_API_URL=https://your-backend.railway.app/api
NEXT_PUBLIC_ENABLE_AI_INSIGHTS=true
NEXT_PUBLIC_ENABLE_OPEN_BANKING=true
NEXT_PUBLIC_STRIPE_PUBLIC_KEY=pk_live_xxxxxxxxxxxxxxxxxxxxx
NEXT_PUBLIC_GOOGLE_ANALYTICS_ID=G-XXXXXXXXXX
NEXT_PUBLIC_FACEBOOK_PIXEL_ID=xxxxxxxxxxxxxxxxxxxxx